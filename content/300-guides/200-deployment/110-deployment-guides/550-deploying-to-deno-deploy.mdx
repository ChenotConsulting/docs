---
title: 'Deploy to Deno Deploy'
metaTitle: 'Deploy to Deno Deploy'
metaDescription: 'Learn how to deploy a TypeScript application to Deno Deploy.'
---

<TopBlock>

With this guide, you can learn how to build a simple application and deploy it to [Deno Deploy](https://deno.com/deploy). The application uses Prisma to save a log of each request to a PostgreSQL database.

This guide covers the use of Prisma CLI with Deno CLI, Prisma Client, Data Proxy, and Deno Deploy.

<Admonition type="info">

This guide demonstrates how to deploy an application to Deno Deploy in conjunction with a PostgreSQL database, but you can use [any database type that Prisma supports](/reference/database-reference/supported-databases).

</Admonition>

</TopBlock>

## Prerequisites

- a free [Deno Deploy](https://deno.com/deploy) account
- a free [GitHub](https://github.com/) account
- a PostgreSQL database
- Node.js & npm installed
- git installed
- [Deno installed](https://deno.land/manual@v1.29.1/getting_started/installation)

## 1. Set up your application

To start, you create a directory for your project, and then use `deno run` to initialize your application with `prisma init` as an [npm package with npm specifiers](https://deno.land/manual@v1.29.1/node/npm_specifiers).

### Steps

1. Open your terminal and navigate to a location of your choice.
2. Run the following commands to set up your application.

  ```terminal
  mkdir prisma-deno-deploy
  cd prisma-deno-deploy
  deno run -A --unstable npm:prisma init
  ```

3. In the generated `prisma/schema.prisma`, add the following schema:

  ```prisma
  generator client {
    provider        = "prisma-client-js"
    previewFeatures = ["deno"]
    output          = "../generated/client"
  }

  datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
  }

  model Log {
    id      Int    @id @default(autoincrement())
    level   Level
    message String
    meta    Json
  }

  enum Level {
    Info
    Warn
    Error
  }
  ```

  This data model defines the `Log` model. Later in the guide, you create an application that uses the `Log` model to store data for incoming requests from the application.

  Note that the `schema.prisma` file includes the preview feature flag `deno` to activate the current preview support for Deno in Prisma Client, and it also defines a custom `output` location for your Prisma Client. This is a requirement for Deno applications.

4. In your `.env` file, replace the current placeholder connection string `postgresql://johndoe:randompassword@localhost:5432/mydb?schema=public` with your actual PostgreSQL connection string.

## 2. Create the database schema

With the data model created and your database connection configured, you can now create the data model in your database.

```terminal
deno run -A --unstable npm:prisma db push
```

This command installs Prisma Client in your project. There is no `package.json` file yet, so the command also creates this file.

## 3. Generate a Prisma Client for Data Proxy

Next, generate a Prisma Client that connects through the [Data Proxy](/data-platform/data-proxy) over HTTP.

```terminal
deno run -A --unstable npm:prisma generate --data-proxy
```

## 4. Create your application and test it locally

You now have a database schema and a generated local Prisma Client. You can now create a minimal local Deno application. 

### Steps

1. Create an `index.ts` with the following content:

  ```ts
  import { serve } from 'https://deno.land/std@0.140.0/http/server.ts'
  import { PrismaClient } from './generated/client/deno/edge.ts'

  const prisma = new PrismaClient()

  async function handler(request: Request) {
    const log = await prisma.log.create({
      data: {
        level: 'Info',
        message: `${request.method} ${request.url}`,
        meta: {
          headers: JSON.stringify(request.headers),
        },
      },
    })
    const body = JSON.stringify(log, null, 2)
    return new Response(body, {
      headers: { 'content-type': 'application/json; charset=utf-8' },
    })
  }

  serve(handler)
  ```

### What's next

You cannot execute this script yet, because you lack the credentials for Data Proxy that let you use this Client with your database. In the next section, you will resolve this.

## 5. Create a repository and push to GitHub

To prepare for the steps ahead, [create a private repository](https://github.com/new) on GitHub.

![Create a private repository](./550-01-create-repo.png)

Next, initialize your repository, then push your changes to GitHub.

```terminal
git init -b main
git remote add origin https://github.com/<username>/prisma-deno-deploy
git add .
git commit -m "initial commit"
git push -u origin main
```

You're ready to import your project into the Prisma Data Platform.

## 6. Create your project in the Prisma Data Platform

The next step is to sign up for Prisma's [Data Proxy](/data-platform/data-proxy).

### Steps

1. Sign up for a free [Prisma Data Platform account](https://cloud.prisma.io/).

   <Admonition type="info">

   **Note**<br /><br />
   You need a GitHub account to sign up for the Prisma Data Platform.

   </Admonition>

   ![Signup for Prisma Data Platform](./450-02-signup-pdp.png)

1. Click **New Project**.
1. Connect the Prisma Data Platform to your database and set up the Data Proxy.

   1. Paste your PostgreSQL connection string.
   1. Under **Choose a Data Proxy region**, select a Data Proxy location that is geographically close to your database.
   1. Click **Create project** to test the connection and set up the Data Proxy.

      You are greeted with a new connection string that starts with `prisma://`.

1. Create a Data Proxy connection string.
  1. On the **Get started** screen, click **Create a new connection string**.
  1. Enter a name for the connection string and click **Create**.
  1. Copy the `prisma://` connection string to your clipboard.

   <!-- TODO redo -->

   ![Data Proxy Page](./450-05-data-proxy.png)

## 7. Set the Data Proxy Connection string in your environment

With the Data Proxy connection string known, you can replace the direct PostgreSQL connection string that you used to create the database schema in your `.env` file.

The Data Proxy Client does not read `.env` files by default, so you must run the following command to install `dotenv-cli` locally:

```
npm install dotenv-cli
```

You are now ready to test your script locally.

## 8. Test your script locally

Execute your script locally:

```terminal
npx dotenv -- deno run -A ./index.ts
```

In a web browser, open [http://localhost:8000/](http://localhost:8000/). This page writes your request to the database.

```
{
  "id": 3,
  "level": "Info",
  "message": "GET http://localhost:8000/",
  "meta": {
    "headers": "{}"
  }
}
```

Refresh the page a couple times to verify that it's working. Now if you click on the **Data Browser** tab on your Prisma Cloud project, you should see `Info` logs written to your database.

![Prisma Data Browser](./450-06-data-browser.png)

It's working locally!

## 9. Deploy to Deno Deploy

You can now deploy the Deno application to Deno Deploy.

### Steps

1. Go to [https://dash.deno.com/new](https://dash.deno.com/new).
1. Select a GitHub organization or user and then select a repository.
1. Select a production branch and select **Automatic** mode so that Deno Deploy can deploy every time you push a change to the repository.
1. Select `index.ts` as the entry point to your project.
1. To define the Data Proxy connection string, click **Add Env Variable**.
    1. For **KEY**, enter `DATABASE_URL`.
    1. For **VALUE**, paste the Data Proxy connection string.
    ![Deno Deploy - project parameters](images/550-0X-deploy-to-deno-deno-project-parameters.png)
1. Click **Link**.<br />
  Wait for the first Deno deployment to finish.

### Result

When the first deployment finishes, your browser is redirected to the project view.

### What's next

Click the blue **View** button at the top right to open the deployed Deno application.

If all works correctly, you can see the same result as when you tested locally.

```
{
  "id": 5,
  "level": "Info",
  "message": "GET https://prisma-deno-deploy.deno.dev/",
  "meta": {
    "headers": "{}"
  }
}
```

## Summary

You successfully deployed a Deno application that you created in TypeScript and that also uses Prisma to connect to a PostgreSQL database.
